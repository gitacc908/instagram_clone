{% extends 'main/base/__base__.html' %}
{% load i18n %}
{% load static %}
{% load humanize %}
{% load user_tags %}

{% block title %}
Instagram
{% endblock %}

{% block styles %}
    <link rel="stylesheet" href="{% static 'css/profile.css' %}">
{% endblock %}


{% block content %}
<main>
	<input hidden id="posts-id" data-comment-url="{% url 'comment' %}" data-reply-url="{% url 'reply' %}" data-save-url="{% url 'save' %}" data-like-url="{% url 'like' %}">
	{% with user_detail as this_user %}
	<header class="header-profile">
		<form id="avatar_form" data-avatar-url="{% url 'avatar' %}" method="post" class="header-profile-user-img" enctype="multipart/form-data" novalidate="">
			{% csrf_token %}
			<button type="button" id="upload_image">
				<input id="upload_image_input" type="file" name="image" accept=".jpg, .jpeg, .png" hidden onchange="loadFile(event)">
				<img class="upload_image_element" src="{{ this_user|get_user_photo }}" alt=""></button>
			</form>
		<div class="header-profile-user-info">
			<!-- Имя профиля, редактирования профиля и настройка -->
			<div class="username-editprofile">
				<div class="header-profile-username">{{this_user.username}}</div>
				<a href="{% url 'edit_profile' request.user.pk %}" class="btn-edit-profile">{% trans 'Редактировать профиль'%}</a>
				<button id="myBtn"><svg aria-label="Параметры" color="#262626" fill="#262626" height="24" role="img" viewBox="0 0 48 48" width="24"><path clip-rule="evenodd" d="M46.7 20.6l-2.1-1.1c-.4-.2-.7-.5-.8-1-.5-1.6-1.1-3.2-1.9-4.7-.2-.4-.3-.8-.1-1.2l.8-2.3c.2-.5 0-1.1-.4-1.5l-2.9-2.9c-.4-.4-1-.5-1.5-.4l-2.3.8c-.4.1-.8.1-1.2-.1-1.4-.8-3-1.5-4.6-1.9-.4-.1-.8-.4-1-.8l-1.1-2.2c-.3-.5-.8-.8-1.3-.8h-4.1c-.6 0-1.1.3-1.3.8l-1.1 2.2c-.2.4-.5.7-1 .8-1.6.5-3.2 1.1-4.6 1.9-.4.2-.8.3-1.2.1l-2.3-.8c-.5-.2-1.1 0-1.5.4L5.9 8.8c-.4.4-.5 1-.4 1.5l.8 2.3c.1.4.1.8-.1 1.2-.8 1.5-1.5 3-1.9 4.7-.1.4-.4.8-.8 1l-2.1 1.1c-.5.3-.8.8-.8 1.3V26c0 .6.3 1.1.8 1.3l2.1 1.1c.4.2.7.5.8 1 .5 1.6 1.1 3.2 1.9 4.7.2.4.3.8.1 1.2l-.8 2.3c-.2.5 0 1.1.4 1.5L8.8 42c.4.4 1 .5 1.5.4l2.3-.8c.4-.1.8-.1 1.2.1 1.4.8 3 1.5 4.6 1.9.4.1.8.4 1 .8l1.1 2.2c.3.5.8.8 1.3.8h4.1c.6 0 1.1-.3 1.3-.8l1.1-2.2c.2-.4.5-.7 1-.8 1.6-.5 3.2-1.1 4.6-1.9.4-.2.8-.3 1.2-.1l2.3.8c.5.2 1.1 0 1.5-.4l2.9-2.9c.4-.4.5-1 .4-1.5l-.8-2.3c-.1-.4-.1-.8.1-1.2.8-1.5 1.5-3 1.9-4.7.1-.4.4-.8.8-1l2.1-1.1c.5-.3.8-.8.8-1.3v-4.1c.4-.5.1-1.1-.4-1.3zM24 41.5c-9.7 0-17.5-7.8-17.5-17.5S14.3 6.5 24 6.5 41.5 14.3 41.5 24 33.7 41.5 24 41.5z" fill-rule="evenodd"></path></svg></button>
			</div>
			<!-- Публикации, подписчики и подписки -->
			<div class="desktop-publications-subscribers-subscriptions">
				<ul class="publications-subscribers-subscriptions">
					<li class="publications"><span>{{ this_user.posts.count }}</span> {% trans 'публикаций'%}</li>
					<li class="subscribers"><span>{{ this_user.followers.count }}</span> {% trans 'подписчиков'%}</li>
					<li class="subscriptions"><span>{{ this_user.following.count }}</span> {%trans 'подписок'%}</li>
				</ul>
			</div>
			<!-- О себе -->
			<div class="desktop-about">
				<div class="user-name">
					{% if this_user.full_name %}
						{{ this_user.full_name }}
					{% endif %}
				</div>
				<div class="about">
					{% if this_user.biography %}
						{{ this_user.biography }}
					{% endif %}
				</div>
			</div>
		</div>
	</header>

	<!-- The Modal -->
	<div id="myModal" class="modal">

		<div class="modal-content-container">
		  <div class="modal-content ">
		    <button>{% trans 'Сменить пароль'%}</button>
		    <button>{% trans 'Уведомления'%}</button>
		    <button>{% trans 'Входы в аккаунт'%}</button>
		    <button>{% trans 'Электронные письма от Instagram'%}</button>
		    <button>{% trans 'Выйти'%}</button>
		    <button class="close" style="border: unset;">{% trans 'Отмена'%}</button>
		  </div>
	    </div>

	</div>
	

	<!-- О себе -->
	<div class="mobile-about">
		<div class="about">
			{% if this_user.biography %}
				{{ this_user.biography }}
			{% endif %}
		</div>
	</div>
	<div class="mobile-publications-subscribers-subscriptions">
		<ul class="publications-subscribers-subscriptions">
			<li class="publications"><span>{{ this_user.posts.count }}</span> {% trans 'публикаций'%}</li>
			<li class="subscribers"><span>{{ this_user.followers.count }}</span> {% trans 'подписчиков'%}</li>
			<li class="subscriptions"><span>{{ this_user.following.count }}</span> {% trans 'подписок'%}</li>
		</ul>
	</div>


		<div class="tabs">
		  <button class="tablinks" onclick="openTab(event, 'publications')" id="defaultOpen">
		  		<svg aria-label="Публикации"  height="24" role="img" viewBox="0 0 48 48" width="24"><path clip-rule="evenodd" d="M45 1.5H3c-.8 0-1.5.7-1.5 1.5v42c0 .8.7 1.5 1.5 1.5h42c.8 0 1.5-.7 1.5-1.5V3c0-.8-.7-1.5-1.5-1.5zm-40.5 3h11v11h-11v-11zm0 14h11v11h-11v-11zm11 25h-11v-11h11v11zm14 0h-11v-11h11v11zm0-14h-11v-11h11v11zm0-14h-11v-11h11v11zm14 28h-11v-11h11v11zm0-14h-11v-11h11v11zm0-14h-11v-11h11v11z" fill-rule="evenodd"></path></svg>
		  		<p>{% trans 'Публикации'%}</p>
		  </button>
		  <button class="tablinks" onclick="openTab(event, 'saves')" id="savedOpen">
		  		<svg aria-label="Сохраненное" height="24" role="img" viewBox="0 0 48 48" width="24"><path d="M43.5 48c-.4 0-.8-.2-1.1-.4L24 29 5.6 47.6c-.4.4-1.1.6-1.6.3-.6-.2-1-.8-1-1.4v-45C3 .7 3.7 0 4.5 0h39c.8 0 1.5.7 1.5 1.5v45c0 .6-.4 1.2-.9 1.4-.2.1-.4.1-.6.1zM24 26c.8 0 1.6.3 2.2.9l15.8 16V3H6v39.9l15.8-16c.6-.6 1.4-.9 2.2-.9z"></path></svg>
		  		<p>{% trans 'Сохраненное'%}</p>
		  </button>
		  <button class="tablinks" onclick="openTab(event, 'marks')">
		  		<svg aria-label="Отметки"  height="24" role="img" viewBox="0 0 48 48" width="24"><path d="M41.5 5.5H30.4c-.5 0-1-.2-1.4-.6l-4-4c-.6-.6-1.5-.6-2.1 0l-4 4c-.4.4-.9.6-1.4.6h-11c-3.3 0-6 2.7-6 6v30c0 3.3 2.7 6 6 6h35c3.3 0 6-2.7 6-6v-30c0-3.3-2.7-6-6-6zm-29.4 39c-.6 0-1.1-.6-1-1.2.7-3.2 3.5-5.6 6.8-5.6h12c3.4 0 6.2 2.4 6.8 5.6.1.6-.4 1.2-1 1.2H12.1zm32.4-3c0 1.7-1.3 3-3 3h-.6c-.5 0-.9-.4-1-.9-.6-5-4.8-8.9-9.9-8.9H18c-5.1 0-9.4 3.9-9.9 8.9-.1.5-.5.9-1 .9h-.6c-1.7 0-3-1.3-3-3v-30c0-1.7 1.3-3 3-3h11.1c1.3 0 2.6-.5 3.5-1.5L24 4.1 26.9 7c.9.9 2.2 1.5 3.5 1.5h11.1c1.7 0 3 1.3 3 3v30zM24 12.5c-5.3 0-9.6 4.3-9.6 9.6s4.3 9.6 9.6 9.6 9.6-4.3 9.6-9.6-4.3-9.6-9.6-9.6zm0 16.1c-3.6 0-6.6-2.9-6.6-6.6 0-3.6 2.9-6.6 6.6-6.6s6.6 2.9 6.6 6.6c0 3.6-3 6.6-6.6 6.6z"></path></svg>
		  		<p>{% trans 'Отметки' %}</p>
		  </button>
		</div>




	<div id="publications" class="tabcontent">
		<div class="grid-publications">
			<!-- публикация 1 -->
			{% for user_post in this_user.posts.all %}
				{% with user_post.images.all|first as preview_image %}
				<div class="publication">
				<!-- The post Modal --> 
					<div class="modal post-window">
						<button class="postclose" style="border: unset;">✕</button>
						<div class="modal-content-container">
							{% if request.user == this_user %}
							<div class="post-setting-container">
								<div class="post-setting-outer">
									<div class="post-setting-inner">
										<a href="{{ user_post.delete_post }}" class="post-setting-button warning">{% trans 'Удалить' %}</a>
										<a href="{{ user_post.get_absolute_url }}" class="post-setting-button">{% trans 'Перейти к публикации' %}</a>
										<a href="#" class="post-setting-button close">{% trans 'Отмена' %}</a>
									</div>
								</div>
							</div>
							{% else %}
						<div class="post-setting-container">
							<div class="post-setting-outer">
								<div class="post-setting-inner">
									{% if user_post.author != request.user and user_post.author not in request.user.following.all %}
									<a href="{{ user_post.unfollow }}" class="post-setting-button warning">{% trans 'Отменить подписку' %}</a>
									{% endif %}
									<a href="{{ user_post.get_absolute_url }}" class="post-setting-button post-link" data-domain="{{ request.get_host }}">{% trans 'Перейти к публикации' %}</a>
									<a href="#" class="post-setting-button">{% trans 'Поделиться' %}...</a>
									<a href="#" class="post-setting-button copy-link">{% trans 'Копировать ссылку' %}</a>
									<a href="#" class="post-setting-button close">{% trans 'Отмена' %}</a>
								</div>
							</div>
						</div>
						{% endif %}
						<div class="post-modal-content">
							<header class="post__header-mobile">
											<div class="post__profile">
												<a href="#" class="post__avatar">
													<img src="{{ this_user|get_user_photo }}" alt="User Picture">
												</a>
												<a href="{{ this_user.get_absolute_url }}" class="post__user">{{ this_user.username }}</a>
											</div>

											<button class="post__more-options">
												<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
													<circle cx="6.5" cy="11.5" r="1.5" fill="var(--text-dark)"></circle>
													<circle cx="12" cy="11.5" r="1.5" fill="var(--text-dark)"></circle>
													<circle cx="17.5" cy="11.5" r="1.5" fill="var(--text-dark)"></circle>
												</svg>
											</button>
							</header>
								<div class="post__content post-content">
									<div class="post__medias post-medias">
										{% for image in user_post.images.all %}
											<img src="{{ image.image.url }}" class="post__media">
										{% endfor %}
									</div>
									<div class="post__indicators post-indicators"></div>
								</div>
								<div class="post-actions">
									<header class="post__header">
											<div class="post__profile">
												<a href="#" class="post__avatar">
													<img src="{{ this_user|get_user_photo }}" alt="User Picture">
												</a>
												<a href="{{ this_user.get_absolute.url }}" class="post__user">{{ this_user.username }}</a>
											</div>

											<button class="post__more-options">
												<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
													<circle cx="6.5" cy="11.5" r="1.5" fill="var(--text-dark)"></circle>
													<circle cx="12" cy="11.5" r="1.5" fill="var(--text-dark)"></circle>
													<circle cx="17.5" cy="11.5" r="1.5" fill="var(--text-dark)"></circle>
												</svg>
											</button>
									</header>
									<div class="post-actions-comments" data-comment-like-url="{% url 'like_comment'%}">
										{% if user_post.body %}
											<div class="user-post-action-comment">
												<div class="user-profile-comment">
													<a href="#">
													<img src="{{ user_post.author|get_user_photo }}" alt="">
													</a>
												</div>
												<div class="user-comment">
													<span class="user-name">{{ user_post.author.username }}</span>
													<p>{{ user_post.body }}
														{% for tag in user_post.tags.all %}
														<a class="tag" href="/">{{ tag }} </a>
														{% endfor %}
													</p>
												
													<div class="action-buttons">
													<a href="#" class="action-button data-comment">{{ user_post.created|naturaltime }}</a>
													</div>
												</div>
											</div>
										{% endif %}
										{% for comment in user_post.comments.all %}
										<div class="user-post-action-comment">
											<div class="user-profile-comment">
											 <a href="#">
											  <img src="{{ comment.user|get_user_photo }}" alt="">
											 </a>
											</div>
											<div class="user-comment">
											 <span class="user-name">{{ comment.user.username }}</span>
											 <p>{{ comment.text }}</p>
											 <div class="action-buttons">
											  <a href="#" class="action-button data-comment">{{ comment.created|naturaltime }}</a><button class="action-button">{% trans 'Нравится:'%} <a href="#" class="comment-like-counter">{{ comment.total_likes }}</a></button><button class="action-button reply-button" data-comment-id="{{ comment.id }}">{% trans 'Ответить'%}</button><button class="action-button complaint">···</button>
											 </div>
											</div>
											<button class="like-comment" data-comment-id="{{ comment.id }}">
												<svg {% if request.user in comment.likes.all %}stroke-width="2"; fill="#ed4956" {% else%} fill="white" stroke="black" {% endif %} aria-label="Не нравится" class="_8-yf5 " color="#ed4956" height="12" role="img" viewBox="0 0 48 48" width="12"><path d="M34.6 3.1c-4.5 0-7.9 1.8-10.6 5.6-2.7-3.7-6.1-5.5-10.6-5.5C6 3.1 0 9.6 0 17.6c0 7.3 5.4 12 10.6 16.5.6.5 1.3 1.1 1.9 1.7l2.3 2c4.4 3.9 6.6 5.9 7.6 6.5.5.3 1.1.5 1.6.5s1.1-.2 1.6-.5c1-.6 2.8-2.2 7.8-6.8l2-1.8c.7-.6 1.3-1.2 2-1.7C42.7 29.6 48 25 48 17.6c0-8-6-14.5-13.4-14.5z"></path></svg>
											</button>
											{% if comment.replies.count > 0 %}
											<div class="reply-counter">
												<button class="show-replies" style="width: 100%; text-align: center; font-weight: bold; font-size: 12px; color: #8d8d8d;">{% trans 'Посмотреть ответы' %} <span>({{ comment.replies.count }})</span></button>
											</div>
											<div class="answer-container">
											{% for reply in comment.replies.all %}

												<div class="answer">
												   <div class="user-post-action-comment-box">
													  <div class="user-profile-comment">
														 <a href="#">
														 <img src="{{ reply.user|get_user_photo}}" alt="">
														 </a>
													  </div>
													  <div class="user-comment">
														 <span class="user-name">
															<!--  --> {{ reply.user.username }}
														 </span>
														 <p>
															<!--  --> {{ reply.text }}
														 </p>
														 <div class="action-buttons">
															<a href="#" class="action-button data-comment">{{ reply.created|naturaltime }}</a>
														   </div>
													  </div>
												   </div>
												</div>
											{% endfor %}

											</div>
											{% endif %}
										</div>
										{% endfor %}
									</div>
									<footer class="post-actions-footer" data-post-id="{{ user_post.id }}" >
										<div class="post__buttons">
												<button class="post__button like_button">
													<svg aria-label="Не нравится" class="_8-yf5 " color="#ed4956" fill="#ed4956" height="24" role="img" viewBox="0 0 48 52" width="24">
														<path {% if request.user not in user_post.likes.all %} fill="#fdfdfd" stroke="#000000" {% else %} fill="rgb(237, 73, 86);" stroke="rgb(237, 73, 86)" {% endif %} stroke-width="3.6" d="M34.6 3.1c-4.5 0-7.9 1.8-10.6 5.6-2.7-3.7-6.1-5.5-10.6-5.5C6 3.1 0 9.6 0 17.6c0 7.3 5.4 12 10.6 16.5.6.5 1.3 1.1 1.9 1.7l2.3 2c4.4 3.9 6.6 5.9 7.6 6.5.5.3 1.1.5 1.6.5s1.1-.2 1.6-.5c1-.6 2.8-2.2 7.8-6.8l2-1.8c.7-.6 1.3-1.2 2-1.7C42.7 29.6 48 25 48 17.6c0-8-6-14.5-13.4-14.5z">
														</path>
													</svg>
												</button>
												<button class="post__button comments_button">
													<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
														<path fill-rule="evenodd" clip-rule="evenodd" d="M21.2959 20.8165L20.2351 16.8602C20.1743 16.6385 20.2047 16.3994 20.309 16.1907C21.2351 14.3342 21.5438 12.117 20.9742 9.80402C20.2003 6.67374 17.757 4.16081 14.6354 3.33042C13.7833 3.10869 12.9442 3 12.1312 3C6.29665 3 1.74035 8.47365 3.31418 14.5647C4.04458 17.3819 7.05314 20.2992 9.88344 20.9861C10.6486 21.173 11.4008 21.26 12.1312 21.26C13.7006 21.26 15.1701 20.8557 16.4614 20.1601C16.6049 20.0818 16.7657 20.0383 16.9222 20.0383C17.0005 20.0383 17.0787 20.047 17.157 20.0688L21.009 21.0991C21.0307 21.1035 21.0525 21.1078 21.0699 21.1078C21.2177 21.1078 21.3351 20.9687 21.2959 20.8165ZM19.0178 17.1863L19.6178 19.4253L17.4831 18.8558C17.3005 18.8079 17.1135 18.7819 16.9222 18.7819C16.557 18.7819 16.1875 18.8775 15.8571 19.0558C14.6963 19.6818 13.4441 19.9992 12.1312 19.9992C11.4834 19.9992 10.8269 19.9166 10.1791 19.7601C7.78354 19.1775 5.14453 16.6037 4.53586 14.2473C3.90111 11.7865 4.40109 9.26057 5.90536 7.31719C7.40964 5.3738 9.6791 4.26081 12.1312 4.26081C12.8529 4.26081 13.5876 4.35646 14.3137 4.5521C16.9961 5.26511 19.0786 7.39544 19.7525 10.1084C20.2264 12.0213 20.0308 13.9299 19.183 15.6298C18.9395 16.1168 18.8787 16.6689 19.0178 17.1863Z" fill="var(--text-dark)" stroke="var(--text-dark)" stroke-width="0.7"></path>
													</svg>
												</button>
												<button class="post__button share-button">
													<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
														<path fill-rule="evenodd" clip-rule="evenodd" d="M22.8555 3.44542C22.6978 3.16703 22.3962 3 22.0714 3L2.91369 3.01392C2.52859 3.01392 2.19453 3.25055 2.05997 3.60781C1.96254 3.86764 1.98574 4.14603 2.11565 4.37338C2.16669 4.45689 2.23165 4.53577 2.31052 4.60537L9.69243 10.9712L11.4927 20.5338C11.5623 20.9096 11.8499 21.188 12.2304 21.2483C12.6062 21.3086 12.9774 21.1323 13.1723 20.8029L22.8509 4.35018C23.0179 4.06715 23.0179 3.72381 22.8555 3.44542ZM4.21748 4.39194H19.8164L10.4255 9.75089L4.21748 4.39194ZM12.6248 18.9841L11.1122 10.948L20.5171 5.58436L12.6248 18.9841Z" fill="var(--text-dark)" stroke="var(--text-dark)" stroke-width="0.3"></path>
													</svg>
												</button>

												<button class="post__button post__button--align-right save-button">
													
													<svg aria-label="Удалить" class="_8-yf5 " color="#262626" fill="#262626" height="24" role="img" viewBox="0 0 48 48" width="24">
														<path stroke-width="3" {% if user_post in request.user.bookmarked.posts.all %} fill="#262626" {% else %} fill="#ffffff" {% endif %} stroke="#262626" d="M43.5 48c-.4 0-.8-.2-1.1-.4L24 28.9 5.6 47.6c-.4.4-1.1.6-1.6.3-.6-.2-1-.8-1-1.4v-45C3 .7 3.7 0 4.5 0h39c.8 0 1.5.7 1.5 1.5v45c0 .6-.4 1.2-.9 1.4-.2.1-.4.1-.6.1z"></path></svg>
												</button>
											</div>
										<div class="post-actions-footer-likes">
											<a class="likes-count">{{ user_post.total_likes }}</a> {% trans 'отметок "Нравится"'%}
										</div>
										<span class="post__date-time profile-post-time">{{ user_post.created|naturaltime }}</span>
										<section class="add-comment sH9wk _JgwE">  
													<div class="RxpZH">
														<form action="" class="X7cDz">
															<textarea data-testid="post-comment-text-area" id="tstid" placeholder="Добавьте комментарий..." class="Ypffh comment-input"></textarea>
															<button data-post-id="{{ user_post.id }}" data-author-of-comment="{{ request.user.username }}" class="sqdOP yWX7d    y3zKF     send-comment" disabled="" data-testid="post-comment-input-button" type="button">{% trans 'Опубликовать'%}</button>
														</form>
													</div>
										</section>
									</footer>
								</div>
							</div>
						</div>
					</div>
					<div class="comments">
						<div class="title-comments">{% trans 'Комментарии'%}</div>
						<div class="post-actions-comments-mobile" data-comment-like-url="{% url 'like_comment'%}">
							{% if user_post.body %}
								<div class="user-post-action-comment">
									<div class="user-profile-comment">
										<a href="#">
										<img src="{{ user_post.author|get_user_photo }}" alt="">
										</a>
									</div>
									<div class="user-comment">
										<span class="user-name">{{ user_post.author.username }}</span>
										<p>{{ user_post.body }}
											{% for tag in user_post.tags.all %}
											<a class="tag" href="/">{{ tag }} </a>
											{% endfor %}
										</p>
										<div class="action-buttons">
										<a href="#" class="action-button data-comment">{{ user_post.created|naturaltime }}</a>
										</div>
									</div>
								</div>
							{% endif %}
							{% for comment in user_post.comments.all %}
							<div class="user-post-action-comment">
								<div class="user-profile-comment">
								 <a href="#">
								  <img src="{{ comment.user|get_user_photo }}" alt="">
								 </a>
								</div>
								<div class="user-comment">
								 <span class="user-name">{{ comment.user.username }}</span>
								 <p>{{ comment.text }}</p>
								 <div class="action-buttons">
								  <a href="#" class="action-button data-comment">{{ comment.created|naturaltime }}</a><button class="action-button">Нравится: <a  href="#" class="comment-like-counter">{{ comment.total_likes }}</a></button><button class="action-button reply-button" data-comment-id="{{ comment.id }}">{% trans 'Ответить'%}</button><button class="action-button complaint">···</button>
								 </div>
								</div>
								<button class="like-comment" data-comment-id="{{ comment.id }}">
									<svg {% if request.user in comment.likes.all %}stroke-width="2"; fill="#ed4956" {% else%} fill="white" stroke="black" {% endif %} aria-label="Не нравится" class="_8-yf5 " color="#ed4956" height="12" role="img" viewBox="0 0 48 48" width="12"><path d="M34.6 3.1c-4.5 0-7.9 1.8-10.6 5.6-2.7-3.7-6.1-5.5-10.6-5.5C6 3.1 0 9.6 0 17.6c0 7.3 5.4 12 10.6 16.5.6.5 1.3 1.1 1.9 1.7l2.3 2c4.4 3.9 6.6 5.9 7.6 6.5.5.3 1.1.5 1.6.5s1.1-.2 1.6-.5c1-.6 2.8-2.2 7.8-6.8l2-1.8c.7-.6 1.3-1.2 2-1.7C42.7 29.6 48 25 48 17.6c0-8-6-14.5-13.4-14.5z"></path></svg>
								</button>
								{% if comment.replies.count > 0 %}
									<div class="reply-counter">
										<button class="show-replies" style="width: 100%; text-align: center; font-weight: bold; font-size: 12px; color: #8d8d8d;">{% trans 'Посмотреть ответы' %} <span>({{ comment.replies.count }})</span></button>
									</div>
									<div class="answer-container">
									{% for reply in comment.replies.all %}
										<div class="answer">
											<div class="user-post-action-comment-box">
												<div class="user-profile-comment">
													<a href="#">
													<img src="{{ reply.user|get_user_photo}}" alt="">
													</a>
												</div>
												<div class="user-comment">
													<span class="user-name">
													<!--  --> {{ reply.user.username }}
													</span>
													<p>
													<!--  --> {{ reply.text }}
													</p>
													<div class="action-buttons">
													<a href="#" class="action-button data-comment">{{ reply.created|naturaltime }}</a>
													</div>
												</div>
											</div>
										</div>
									{% endfor %}
									</div>
								{% endif %}
							</div>
							{% endfor %}
						</div>
						<section class="add-comment sH9wk _JgwE">  
							<div class="RxpZH">
								<form action="" class="X7cDz">
									<textarea data-testid="post-comment-text-area" id="tstid" placeholder="Добавьте комментарий..." class="Ypffh comment-input"></textarea>
									<button data-post-id="{{ user_post.id }}" data-author-of-comment="{{ request.user.username }}" class="sqdOP yWX7d    y3zKF     send-comment" disabled="" data-testid="post-comment-input-button" type="button">{% trans 'Ответить'%}</button>
								</form>
							</div>
						</section>
					</div>
					<a href="#" id="postBtn" class="publication-link">
						<img src="{{ preview_image.image.url }}" alt="">
						<div class="likes-comments-hover">
							<div class="hover-likes"><span>{{ user_post.likes.count }} </span> {% trans 'likes'%}</div>
							<div class="hover-comments"><span>{{ user_post.comments.count }}</span> {% trans 'comments'%}</div>
						</div>
					</a>
				</div>
				{% endwith %}
			{% endfor %}
	  	</div>
	</div>

	<div id="saves" class="tabcontent">
		<div class="new-selection">
			<p>{% trans 'Список сохраненного виден только вам' %}</p>
			<button>+ Новая подборка</button>
		</div>
	  <div class="grid-publications">
			<!-- публикация 1 -->
			{% for bookmark in this_user.bookmarked.posts.all %}
				{% with bookmark.images.all|first as preview_image %}
				<div class="publication">
					<!-- The post Modal --> 
					<div class="modal post-window">
						<button class="postclose" style="border: unset;">✕</button>
						<div class="modal-content-container">
							{% if request.user == bookmark.author %}
							<div class="post-setting-container">
								<div class="post-setting-outer">
									<div class="post-setting-inner">
										<a href="{{ bookmark.delete_post }}" class="post-setting-button warning">{% trans 'Удалить' %}</a>
										<a href="{{ bookmark.get_absolute_url }}" class="post-setting-button">{% trans 'Перейти к публикации' %}</a>
										<a href="#" class="post-setting-button close">{% trans 'Отмена' %}</a>
									</div>
								</div>
							</div>
							{% else %}
							<div class="post-setting-container">
								<div class="post-setting-outer">
									<div class="post-setting-inner">
									{% if bookmark.author != request.user and bookmark.author in request.user.following.all %}
										<a href="{{ bookmark.unfollow }}" class="post-setting-button warning">{% trans 'Отменить подписку' %}</a>
										{% endif %}
										<a href="{{ bookmark.get_absolute_url }}" class="post-setting-button post-link" data-domain="{{ request.get_host }}">{% trans 'Перейти к публикации' %}</a>
										<a href="#" class="post-setting-button">{% trans 'Поделиться' %}...</a>
										<a href="#" class="post-setting-button copy-link">{% trans 'Копировать ссылку' %}</a>
										<a href="#" class="post-setting-button close">{% trans 'Отмена' %}</a>
									</div>
								</div>
							</div>
						{% endif %}
						<div class="post-modal-content">
							<header class="post__header-mobile">
											<div class="post__profile">
												<a href="#" class="post__avatar">
													<img src="{{ bookmark.author|get_user_photo }}" alt="User Picture">
												</a>
												<a href="{{ bookmark.author.get_absolute_url }}" class="post__user">{{ bookmark.author.username }}</a>
											</div>

											<button class="post__more-options">
												<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
													<circle cx="6.5" cy="11.5" r="1.5" fill="var(--text-dark)"></circle>
													<circle cx="12" cy="11.5" r="1.5" fill="var(--text-dark)"></circle>
													<circle cx="17.5" cy="11.5" r="1.5" fill="var(--text-dark)"></circle>
												</svg>
											</button>
							</header>
								<div class="post__content post-content">
									<div class="post__medias post-medias">
										{% for image in bookmark.images.all %}
											<img src="{{ image.image.url }}" class="post__media">
										{% endfor %}
									</div>
									<div class="post__indicators post-indicators"></div>
								</div>
								<div class="post-actions">
									<header class="post__header">
											<div class="post__profile">
												<a href="#" class="post__avatar">
													<img src="{{ bookmark.author|get_user_photo }}" alt="User Picture">
												</a>
												<a href="{{ bookmark.author.get_absolute.url }}" class="post__user">{{ bookmark.author.username }}</a>
											</div>

											<button class="post__more-options">
												<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
													<circle cx="6.5" cy="11.5" r="1.5" fill="var(--text-dark)"></circle>
													<circle cx="12" cy="11.5" r="1.5" fill="var(--text-dark)"></circle>
													<circle cx="17.5" cy="11.5" r="1.5" fill="var(--text-dark)"></circle>
												</svg>
											</button>
									</header>
									<div class="post-actions-comments" data-comment-like-url="{% url 'like_comment'%}">
										{% if bookmark.body %}
											<div class="user-post-action-comment">
												<div class="user-profile-comment">
													<a href="#">
													<img src="{{ bookmark.author|get_user_photo }}" alt="">
													</a>
												</div>
												<div class="user-comment">
													<span class="user-name">{{ bookmark.author.username }}</span>
													<p>{{ bookmark.body }}
														{% for tag in bookmark.tags.all %}
														<a class="tag" href="/">{{ tag }} </a>
														{% endfor %}
													</p>
													<div class="action-buttons">
													<a href="#" class="action-button data-comment">{{ bookmark.created|naturaltime }}</a>
													</div>
												</div>
											</div>
										{% endif %}
										{% for comment in bookmark.comments.all %}
										<div class="user-post-action-comment">
											<div class="user-profile-comment">
											 <a href="#">
											  <img src="{{ comment.user|get_user_photo }}" alt="">
											 </a>
											</div>
											<div class="user-comment">
											 <span class="user-name">{{ comment.user.username }}</span>
											 <p>{{ comment.text }}</p>
											 <div class="action-buttons">
											  <a href="#" class="action-button data-comment">{{ comment.created|naturaltime }}</a><button class="action-button">Нравится: <a href="#" class="comment-like-counter">{{ comment.total_likes }}</a></button><button class="action-button reply-button" data-comment-id="{{ comment.id }}">{% trans 'Ответить' %}</button><button class="action-button complaint">···</button>
											 </div>
											</div>
											<button class="like-comment" data-comment-id="{{ comment.id }}">
												<svg {% if request.user in comment.likes.all %}stroke-width="2"; fill="#ed4956" {% else%} fill="white" stroke="black" {% endif %} aria-label="Не нравится" class="_8-yf5 " color="#ed4956" height="12" role="img" viewBox="0 0 48 48" width="12"><path d="M34.6 3.1c-4.5 0-7.9 1.8-10.6 5.6-2.7-3.7-6.1-5.5-10.6-5.5C6 3.1 0 9.6 0 17.6c0 7.3 5.4 12 10.6 16.5.6.5 1.3 1.1 1.9 1.7l2.3 2c4.4 3.9 6.6 5.9 7.6 6.5.5.3 1.1.5 1.6.5s1.1-.2 1.6-.5c1-.6 2.8-2.2 7.8-6.8l2-1.8c.7-.6 1.3-1.2 2-1.7C42.7 29.6 48 25 48 17.6c0-8-6-14.5-13.4-14.5z"></path></svg>
											</button>
											{% if comment.replies.count > 0 %}
												<div class="reply-counter">
													<button class="show-replies" style="width: 100%; text-align: center; font-weight: bold; font-size: 12px; color: #8d8d8d;">{% trans 'Посмотреть ответы' %} <span>({{ comment.replies.count }})</span></button>
												</div>
												<div class="answer-container">
												{% for reply in comment.replies.all %}
													<div class="answer">
														<div class="user-post-action-comment-box">
															<div class="user-profile-comment">
																<a href="#">
																<img src="{{ reply.user|get_user_photo}}" alt="">
																</a>
															</div>
															<div class="user-comment">
																<span class="user-name">
																<!--  --> {{ reply.user.username }}
																</span>
																<p>
																<!--  --> {{ reply.text }}
																</p>
																<div class="action-buttons">
																<a href="#" class="action-button data-comment">{{ reply.created|naturaltime }}</a>
																</div>
															</div>
														</div>
													</div>
												{% endfor %}
												</div>
											{% endif %}
										</div>
										{% endfor %}
									</div>
									<footer class="post-actions-footer" data-post-id="{{ bookmark.id }}">
										<div class="post__buttons">
												<button class="post__button like_button">
													<svg aria-label="Не нравится" class="_8-yf5 " color="#ed4956" fill="#ed4956" height="24" role="img" viewBox="0 0 48 52" width="24">
														<path {% if request.user not in bookmark.likes.all %} fill="#fdfdfd" stroke="#000000" {% else %} fill="rgb(237, 73, 86);" stroke="rgb(237, 73, 86)" {% endif %} stroke-width="3.6" d="M34.6 3.1c-4.5 0-7.9 1.8-10.6 5.6-2.7-3.7-6.1-5.5-10.6-5.5C6 3.1 0 9.6 0 17.6c0 7.3 5.4 12 10.6 16.5.6.5 1.3 1.1 1.9 1.7l2.3 2c4.4 3.9 6.6 5.9 7.6 6.5.5.3 1.1.5 1.6.5s1.1-.2 1.6-.5c1-.6 2.8-2.2 7.8-6.8l2-1.8c.7-.6 1.3-1.2 2-1.7C42.7 29.6 48 25 48 17.6c0-8-6-14.5-13.4-14.5z">
														</path>
													</svg>
												</button>
												<button class="post__button comments_button">
													<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
														<path fill-rule="evenodd" clip-rule="evenodd" d="M21.2959 20.8165L20.2351 16.8602C20.1743 16.6385 20.2047 16.3994 20.309 16.1907C21.2351 14.3342 21.5438 12.117 20.9742 9.80402C20.2003 6.67374 17.757 4.16081 14.6354 3.33042C13.7833 3.10869 12.9442 3 12.1312 3C6.29665 3 1.74035 8.47365 3.31418 14.5647C4.04458 17.3819 7.05314 20.2992 9.88344 20.9861C10.6486 21.173 11.4008 21.26 12.1312 21.26C13.7006 21.26 15.1701 20.8557 16.4614 20.1601C16.6049 20.0818 16.7657 20.0383 16.9222 20.0383C17.0005 20.0383 17.0787 20.047 17.157 20.0688L21.009 21.0991C21.0307 21.1035 21.0525 21.1078 21.0699 21.1078C21.2177 21.1078 21.3351 20.9687 21.2959 20.8165ZM19.0178 17.1863L19.6178 19.4253L17.4831 18.8558C17.3005 18.8079 17.1135 18.7819 16.9222 18.7819C16.557 18.7819 16.1875 18.8775 15.8571 19.0558C14.6963 19.6818 13.4441 19.9992 12.1312 19.9992C11.4834 19.9992 10.8269 19.9166 10.1791 19.7601C7.78354 19.1775 5.14453 16.6037 4.53586 14.2473C3.90111 11.7865 4.40109 9.26057 5.90536 7.31719C7.40964 5.3738 9.6791 4.26081 12.1312 4.26081C12.8529 4.26081 13.5876 4.35646 14.3137 4.5521C16.9961 5.26511 19.0786 7.39544 19.7525 10.1084C20.2264 12.0213 20.0308 13.9299 19.183 15.6298C18.9395 16.1168 18.8787 16.6689 19.0178 17.1863Z" fill="var(--text-dark)" stroke="var(--text-dark)" stroke-width="0.7"></path>
													</svg>
												</button>
												<button class="post__button share-button">
													<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
														<path fill-rule="evenodd" clip-rule="evenodd" d="M22.8555 3.44542C22.6978 3.16703 22.3962 3 22.0714 3L2.91369 3.01392C2.52859 3.01392 2.19453 3.25055 2.05997 3.60781C1.96254 3.86764 1.98574 4.14603 2.11565 4.37338C2.16669 4.45689 2.23165 4.53577 2.31052 4.60537L9.69243 10.9712L11.4927 20.5338C11.5623 20.9096 11.8499 21.188 12.2304 21.2483C12.6062 21.3086 12.9774 21.1323 13.1723 20.8029L22.8509 4.35018C23.0179 4.06715 23.0179 3.72381 22.8555 3.44542ZM4.21748 4.39194H19.8164L10.4255 9.75089L4.21748 4.39194ZM12.6248 18.9841L11.1122 10.948L20.5171 5.58436L12.6248 18.9841Z" fill="var(--text-dark)" stroke="var(--text-dark)" stroke-width="0.3"></path>
													</svg>
												</button>

												<button class="post__button post__button--align-right save-button">
													<svg aria-label="Удалить" class="_8-yf5 " color="#262626" fill="#262626" height="24" role="img" viewBox="0 0 48 48" width="24">
														<path stroke-width="3" {% if bookmark in request.user.bookmarked.posts.all %} fill="#262626" {% else %} fill="#ffffff" {% endif %} stroke="#262626" d="M43.5 48c-.4 0-.8-.2-1.1-.4L24 28.9 5.6 47.6c-.4.4-1.1.6-1.6.3-.6-.2-1-.8-1-1.4v-45C3 .7 3.7 0 4.5 0h39c.8 0 1.5.7 1.5 1.5v45c0 .6-.4 1.2-.9 1.4-.2.1-.4.1-.6.1z"></path></svg>
												</button>
											</div>
										<div class="post-actions-footer-likes">
											<a class="likes-count">{{ bookmark.total_likes }}</a> отметок "Нравится"
										</div>
										<span class="post__date-time profile-post-time">{{ bookmark.created|naturaltime }}</span>
										<section class="add-comment sH9wk _JgwE">  
													<div class="RxpZH">
														<form action="" class="X7cDz">
															<textarea data-testid="post-comment-text-area" id="tstid" placeholder="Добавьте комментарий..." class="Ypffh comment-input"></textarea>
															<button data-post-id="{{ bookmark.id }}" data-author-of-comment="{{ request.user.username }}" class="sqdOP yWX7d    y3zKF     send-comment" disabled="" data-testid="post-comment-input-button" type="button">Опубликовать</button>
														</form>
													</div>
										</section>
									</footer>
								</div>
							</div>
						</div>
					</div>
					<div class="comments">
						<div class="title-comments">{% trans 'Комментарии'%} <button class="closebtn"><svg viewBox="0 0 48 48"><path d="M38 12.83l-2.83-2.83-11.17 11.17-11.17-11.17-2.83 2.83 11.17 11.17-11.17 11.17 2.83 2.83 11.17-11.17 11.17 11.17 2.83-2.83-11.17-11.17z"/><path d="M0 0h48v48h-48z" fill="none"/></svg></button> </div>
						<div class="post-actions-comments-mobile" data-comment-like-url="{% url 'like_comment'%}">
							{% if bookmark.body %}
								<div class="user-post-action-comment">
									<div class="user-profile-comment">
										<a href="#">
										<img src="{{ bookmark.author|get_user_photo }}" alt="">
										</a>
									</div>
									<div class="user-comment">
										<span class="user-name">{{ bookmark.author.username }}</span>
										<p>{{ bookmark.body }}
											{% for tag in bookmark.tags.all %}
											<a class="tag" href="/">{{ tag }} </a>
											{% endfor %}
										</p>
										<div class="action-buttons">
										<a href="#" class="action-button data-comment">{{ bookmark.created|naturaltime }}</a>
										</div>
									</div>
								</div>
							{% endif %}
							{% for comment in bookmark.comments.all %}
							<div class="user-post-action-comment">
								<div class="user-profile-comment">
								 <a href="#">
								  <img src="{{ comment.user|get_user_photo }}" alt="">
								 </a>
								</div>
								<div class="user-comment">
								 <span class="user-name">{{ comment.user.username }}</span>
								 <p>{{ comment.text }}</p>
								 <div class="action-buttons">
								  <a href="#" class="action-button data-comment">{{ comment.created|naturaltime }}</a><button class="action-button">Нравится: <a href="#" class="comment-like-counter">{{ comment.total_likes }}</a></button><button class="action-button reply-button" data-comment-id="{{ comment.id }}">{% trans 'Ответить'%}</button><button class="action-button complaint">···</button>
								 </div>
								</div>
								<button class="like-comment" data-comment-id="{{ comment.id }}">
									<svg {% if request.user in comment.likes.all %}stroke-width="2"; fill="#ed4956" {% else%} fill="white" stroke="black" {% endif %} aria-label="Не нравится" class="_8-yf5 " color="#ed4956" height="12" role="img" viewBox="0 0 48 48" width="12"><path d="M34.6 3.1c-4.5 0-7.9 1.8-10.6 5.6-2.7-3.7-6.1-5.5-10.6-5.5C6 3.1 0 9.6 0 17.6c0 7.3 5.4 12 10.6 16.5.6.5 1.3 1.1 1.9 1.7l2.3 2c4.4 3.9 6.6 5.9 7.6 6.5.5.3 1.1.5 1.6.5s1.1-.2 1.6-.5c1-.6 2.8-2.2 7.8-6.8l2-1.8c.7-.6 1.3-1.2 2-1.7C42.7 29.6 48 25 48 17.6c0-8-6-14.5-13.4-14.5z"></path></svg>
								</button>
								{% if comment.replies.count > 0 %}
									<div class="reply-counter">
										<button class="show-replies" style="width: 100%; text-align: center; font-weight: bold; font-size: 12px; color: #8d8d8d;">{% trans 'Посмотреть ответы' %} <span>({{ comment.replies.count }})</span></button>
									</div>
									<div class="answer-container">
									{% for reply in comment.replies.all %}
										<div class="answer">
											<div class="user-post-action-comment-box">
												<div class="user-profile-comment">
													<a href="#">
													<img src="{{ reply.user|get_user_photo}}" alt="">
													</a>
												</div>
												<div class="user-comment">
													<span class="user-name">
													<!--  --> {{ reply.user.username }}
													</span>
													<p>
													<!--  --> {{ reply.text }}
													</p>
													<div class="action-buttons">
													<a href="#" class="action-button data-comment">{{ reply.created|naturaltime }}</a>
													</div>
												</div>
											</div>
										</div>
									{% endfor %}
									</div>
								{% endif %}
							</div>
							{% endfor %}	
						</div>
						<section class="add-comment sH9wk _JgwE">  
							<div class="RxpZH">
								<form action="" class="X7cDz">
									<textarea data-testid="post-comment-text-area" id="tstid" placeholder="Добавьте комментарий..." class="Ypffh comment-input"></textarea>
									<button data-post-id="{{ bookmark.id }}" data-author-of-comment="{{ request.user.username }}" class="sqdOP yWX7d    y3zKF     send-comment" disabled="" data-testid="post-comment-input-button" type="button">{% trans 'Опубликовать'%}</button>
								</form>
							</div>
						</section>
					</div>
					<a href="#" id="postBtn" class="publication-link">
						<img src="{{ preview_image.image.url }}" alt="">
						<div class="likes-comments-hover">
							<div class="hover-likes"><span>{{ bookmark.likes.count }}</span> {% trans 'likes'%}</div>
							<div class="hover-comments"><span>{{ bookmark.comments.count }}</span> {% trans 'comments'%}</div>
						</div>
					</a>
				</div>
				{% endwith %}
			{% endfor %}
	  	</div> 
	</div>

	<div id="marks" class="tabcontent">
		<div class="grid-publications">
			<!-- публикация 1 -->
			<div class="publication">
				<a href="#" id="postBtn" class="publication-link">
					<img src="https://cdnimg.rg.ru/img/content/220/87/86/android1(istock)1000_d_850.jpg" alt="">
					<div class="likes-comments-hover">
						<div class="hover-likes"><span>1</span> {% trans 'likes'%}</div>
						<div class="hover-comments"><span>4</span> {% trans 'comments'%}</div>
					</div>
				</a>
			</div>
			<div class="publication"></div>
	  	</div> 
	</div>
{% endwith %}

</main>
{% endblock %}

{% block scripts %}

<script src="{% static 'js/modals.js' %}"> </script>
<script src="{% static 'js/profile_modals.js' %}"> </script>
<script src="{% static 'js/modal_slider.js'%}"></script>
<script src="{% static 'js/profile_tabs.js'%}"></script>
<script src="{% static 'js/profile_ajax.js' %}"></script>

<script src="{% static 'js/avatar_update.js' %}"> </script>
{% endblock %}

{% block csrf_ready %}
{% endblock %}
