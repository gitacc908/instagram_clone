{% extends 'main/base/__base__.html' %}
<!-- {% load static %}
{% load humanize %}
{% load custom_tags %} -->
<!-- {% load emoji_tags %} -->


    {% block title %}
    Instagram
    {% endblock %}
    
    {%  block styles %}
    <!-- <link rel="stylesheet" type="text/css" href="{% static 'css/tinyslide.css' %}"> -->
    <!-- <link rel="stylesheet" href="{% static 'css/emojionearea.min.css' %}"> -->
    {% endblock %}


{% block content %}
    <main class="main-container">
        <section class="content-container">
            <div class="content">
                <div class="stories">
                    <button class="stories__left-button">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                            <path fill="var(--primary)" d="M256 504C119 504 8 393 8 256S119 8 256 8s248 111 248 248-111 248-248 248zM142.1 273l135.5 135.5c9.4 9.4 24.6 9.4 33.9 0l17-17c9.4-9.4 9.4-24.6 0-33.9L226.9 256l101.6-101.6c9.4-9.4 9.4-24.6 0-33.9l-17-17c-9.4-9.4-24.6-9.4-33.9 0L142.1 239c-9.4 9.4-9.4 24.6 0 34z"></path>
                        </svg>
                    </button>
                    <div class="stories__content">
                        <button class="story story--has-story">
                            <div class="story__avatar">
                                <div class="story__border">
                                    <svg width="64" height="64" xmlns="http://www.w3.org/2000/svg">
                                        <circle r="31" cy="32" cx="32"/>
                                        <defs>
                                            <linearGradient y2="0" x2="1" y1="1" x1="0" id="--story-gradient">
                                                <stop offset="0" stop-color="#f09433"/>
                                                <stop offset="0.25" stop-color="#e6683c"/>
                                                <stop offset="0.5" stop-color="#dc2743"/>
                                                <stop offset="0.75" stop-color="#cc2366"/>
                                                <stop offset="1" stop-color="#bc1888"/>
                                            </linearGradient>
                                        </defs>
                                    </svg>
                                </div>
                                <div class="story__picture">
                                    <img src="{% static 'assets/default-user.png' %}" alt="User Picture">
                                </div>
                            </div>
                            <span class="story__user">usernick1</span>
                        </button>
                    </div>
                    <button class="stories__right-button">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                            <path fill="var(--primary)" d="M256 8c137 0 248 111 248 248S393 504 256 504 8 393 8 256 119 8 256 8zm113.9 231L234.4 103.5c-9.4-9.4-24.6-9.4-33.9 0l-17 17c-9.4 9.4-9.4 24.6 0 33.9L285.1 256 183.5 357.6c-9.4 9.4-9.4 24.6 0 33.9l17 17c9.4 9.4 24.6 9.4 33.9 0L369.9 273c9.4-9.4 9.4-24.6 0-34z"></path>
                        </svg>
                    </button>
                </div>

                <div class="posts" id="posts-id" data-comment-url="{% url 'comment' %}" data-like-url="{% url 'like' %}" data-save-url="{% url 'save' %}">
                    {% include 'list_ajax/posts.html' %}
                </div>
            </div>

            <section class="side-menu">
                <div class="side-menu__user-profile">
                    <a href="" target="_blank" class="side-menu__user-avatar">
                    {% if request.user.image %}
                        <img class="prof-image" src="{{ request.user.image.url }}" alt="User Picture">
                    {% else %}
                        <img src="{% static 'assets/default-user.png' %}" alt="User Picture">
                    {% endif %}
                    </a>
                    <div class="side-menu__user-info">
                        <a id="myusername" href="#" target="_blank">{{ request.user.username }}</a>
                        {% if request.user.full_name %}
                        <span>{{ request.user.full_name  }}</span>
                        {% else %}
                        <span>{{ request.user.username }}</span>
                        {% endif %}
                    </div>
                    <button class="side-menu__user-button">Switch</button>
                </div>

                <div class="side-menu__suggestions-section">
                    <div class="side-menu__suggestions-header">
                        <h2>Suggestions for You</h2>
                        <button>See All</button>
                    </div>
                    <div class="side-menu__suggestions-content">
                        {% for suggestion in request.user|follow_suggestion %}
                            <div class="side-menu__suggestion">
                                <a href="#" class="side-menu__suggestion-avatar">
                                    <img src="{% if suggestion.image %} {{ suggestion.image.url }} {% else %} {% static 'assets/default-user.png' %} {% endif %}" alt="User Picture">
                                </a>
                                <div class="side-menu__suggestion-info">
                                    <a href="{{ suggestion.get_absolute_url }}">{{ suggestion.username }}</a>
                                    <span>Followed by user1, user2 and 9 others</span>
                                </div>
                                <button class="side-menu__suggestion-button follow" data-follow-url="{% url 'follow' %}" data-user-id="{{ suggestion.id }}">Follow</button>
                            </div>
                        {% endfor %}
                    </div>
                </div>
                <div class="side-menu__footer">
                    <div class="side-menu__footer-links">
                        <ul class="side-menu__footer-list">
                            <li class="side-menu__footer-item">
                                <a class="side-menu__footer-link" href="#">About</a>
                            </li>
                            <li class="side-menu__footer-item">
                                <a class="side-menu__footer-link" href="#">Help</a>
                            </li>
                            <li class="side-menu__footer-item">
                                <a class="side-menu__footer-link" href="#">Press</a>
                            </li>
                            <li class="side-menu__footer-item">
                                <a class="side-menu__footer-link" href="#">API</a>
                            </li>
                            <li class="side-menu__footer-item">
                                <a class="side-menu__footer-link" href="#">Jobs</a>
                            </li>
                            <li class="side-menu__footer-item">
                                <a class="side-menu__footer-link" href="#">Privacy</a>
                            </li>
                            <li class="side-menu__footer-item">
                                <a class="side-menu__footer-link" href="#">Terms</a>
                            </li>
                            <li class="side-menu__footer-item">
                                <a class="side-menu__footer-link" href="#">Locations</a>
                            </li>
                            <li class="side-menu__footer-item">
                                <a class="side-menu__footer-link" href="#">Top Accounts</a>
                            </li>
                            <li class="side-menu__footer-item">
                                <a class="side-menu__footer-link" href="#">Hashtag</a>
                            </li>
                            <li class="side-menu__footer-item">
                                <a class="side-menu__footer-link" href="#">Language</a>
                            </li>
                        </ul>
                    </div>

                    <span class="side-menu__footer-copyright">&copy; 2021 instagram from Malikov Adilet</span>
                </div>
            </section>
        </section>
    </main>

{% endblock %}
<!-- 
    <div id='recaptcha-container'>
    </div>  -->
 

  {% block scripts %}
  <!-- <script type="text/javascript" src="{% static 'js/emojionearea.min.js' %}"></script> -->

  <!-- Insert these scripts at the bottom of the HTML, but before you use any Firebase services -->

  {% comment %} <!-- Firebase App (the core Firebase SDK) is always required and must be listed first -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>

  <!-- If you enabled Analytics in your project, add the Firebase SDK for Analytics -->
  <!-- <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-analytics.js"></script> -->

  <!-- Add Firebase products that you want to use -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
  <!-- <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script> --> {% endcomment %}

   <script>
   
    // TODO: Replace the following with your app's Firebase project configuration
    // For Firebase JavaScript SDK v7.20.0 and later, `measurementId` is an optional field
 
//     // For Firebase JS SDK v7.20.0 and later, measurementId is optional
//   const firebaseConfig = {
//     apiKey: "AIzaSyBHxC2yBovLR0MUM56JHcCeDhfDQVEz8vQ",
//     authDomain: "project-86088.firebaseapp.com",
//     projectId: "project-86088",
//     storageBucket: "project-86088.appspot.com",
//     messagingSenderId: "163034169517",
//     appId: "1:163034169517:web:1160bd803cf2e533c84624",
//     measurementId: "G-HQBXMKHQSQ"
//     };

//     // Initialize Firebase
//     firebase.initializeApp(firebaseConfig);

//     firebase.auth().settings.appVerificationDisabledForTesting = true;
//     firebase.auth().useDeviceLanguage();

//     $(function() {
//         window.recaptchaVerifier = new firebase.auth.RecaptchaVerifier('recaptcha-container', {
//         'size': 'invisible',
//         'callback': function (recapchaToken) {
//             // reCAPTCHA solved, send recapchaToken and phone number to backend.
            
//             // a REST call to your backend
//             console.log('callback')
//         }
//         });
//     window.recaptchaVerifier.render().then(function (widgetId) {
//     window.recaptchaWidgetId = widgetId;
//     });
        
//     const phoneNumber = prompt('phone pls?')
//     const appVerifier = window.recaptchaVerifier
//     firebase.auth().signInWithPhoneNumber(phoneNumber, appVerifier).then((confirmationResult) => {
//       // SMS sent. Prompt user to type the code from the message, then sign the
//       // user in with confirmationResult.confirm(code).
//       let code = prompt('code pls?')
//       window.confirmationResult = code;
//           // const code = getCodeFromUserInput();
//         // confirmationResult.confirm(code).then((result) => {
//         //     console.log('successfully confirmed')
//         // // User signed in successfully.
//         // // const user = result.user;
//         // // ...
//         // }).catch((error) => {
//         //     console.log('User couldnt sign in (bad verification code?)')

//         // // User couldn't sign in (bad verification code?)
//         // // ...
//         // });
//       // ...
//     }).catch((error) => {
//         console.log(' // Error; SMS not sent')
//         console.log(error)

//       // ...
//     });


// });


    // $('.comment-input').emojioneArea(
    //     // { }
    // );
  
    </script>
<script src="{% static 'js/script.js' %}" defer></script>
<script src="{% static 'js/modals.js' %}"> </script>
    
<script>
$(document).ready(function(){
    var page = 1;
    var empty_page = false;
    var block_request = false;
    $(window).scroll(function() {
        var margin = $(document).height() - $(window).height() - 200;
        if($(window).scrollTop() > margin && empty_page == false && block_request == false){
            block_request = true;
            page += 1;
            $.get('?page=' + page, function(data) {
                if(data == '') {
                    empty_page = true;
                }
                else {
                    block_request = false;
                    $('#posts-id').append(data);
                }
            });
        }
    });

});
    
</script>
{% endblock %}


{% block csrf_ready %}
{% endblock %}
